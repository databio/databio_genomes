metadata:
  sample_table: genomes.csv
  subsample_table: assets.csv

  output_dir: $GENOMES
  pipeline_interfaces: refgenie_piface.yaml

constant_attributes:
  protocol: "refgenie"
  destdir: "LOCALDIR"
  local_fa: "LOCAL_FA"
  local_gencode_gtf: "LOCAL_GENCODE_GTF"
  local_ensembl_gtf: "LOCAL_ENSEMBL_GTF"
  local_ensembl_rb: "LOCAL_ENSEMBL_RB"

derived_attributes: ['destdir', 'local_fa', 'local_gtf',  'local_gencode_gtf', 'local_ensembl_gtf', 'local_ensembl_rb']

data_sources:
  LOCALDIR: "/project/shefflab/www/refgenie_raw/"
  LOCAL_FA: "{destdir}/{genome}.fa.gz"
  SRCFILE_FA: "{fasta}"
  LOCAL_GENCODE_GTF: "{destdir}/{genome}_gencode.gtf.gz"
  LOCAL_ENSEMBL_GTF: "{destdir}/{genome}_ensembl.gtf.gz"
  LOCAL_ENSEMBL_RB: "{destdir}/{genome}_ensembl_rb.gff.gz"
  SRCFILE_GTF: "{gencode_gtf}"

subprojects:
  derive_sample_name:
    constant_attributes:
      sample_name: "genome_asset"
      protocol: "refgenie"
    derived_attributes: [sample_name]
    data_sources:
      genome_asset: "{genome}_{asset}"

  getfasta:
    metadata:
      pipeline_interfaces: $CODE/pifaces/wget_piface.yaml
      subsample_table: null
    constant_attributes:
      destdir: "LOCALDIR"
      destfile: "LOCAL_FA"
      src: "SRCFILE_FA"
    derived_attributes: ["src", "destdir", "destfile"]

  getgtf:
    metadata:
      pipeline_interfaces: $CODE/pifaces/wget_piface.yaml
      subsample_table: null
    constant_attributes:
      destdir: "LOCALDIR"
      destfile: "LOCAL_GENCODE_GTF"
      src: "SRCFILE_GTF"
    derived_attributes: ["src", "destdir", "destfile"]
